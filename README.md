# ğŸ«í”„ë¡œì íŠ¸ ëª©ì 
ë¦¬ë·° í† í°í™” í›„ ì›Œë“œí´ë¼ìš°ë“œë¥¼ ìƒì„± ì‹œ 2ê°€ì§€ ë¬¸ì œë¥¼ í™•ì¸
1. ê¸ì • ë¶€ì • êµ¬ë¶„ ë¶ˆê°€
   "í¬ì§€ ì•Šë‹¤" > "í¬ë‹¤" "ì•Šë‹¤" ì˜ í˜•íƒœë¡œ í† í°í™”ë˜ì–´ "í¬ë‹¤"ì™€ "ì•Šë‹¤"ê°€ ê°ê° ì§‘ê³„ë¨
2. ë¦¬ë·°ë¥¼ ë©€í‹°ë¼ë²¨ ë¶„ë¥˜ë¥¼ í•˜ë©´ í•˜ë‚˜ì˜ ë¦¬ë·°ì— ì—¬ëŸ¬ í‚¤ì›Œë“œê°€ í¬í•¨ë¨
   "ì˜·ì€ ì§§ì§€ë§Œ ë””ìì¸ì´ ì´ë»ìš”" > ëŒ€ì‹œë³´ë“œì—ì„œ ë””ìì¸ í‚¤ì›Œë“œë¥¼ ì„ íƒí•˜ë”ë¼ë„ ê¸¸ì´ì— ëŒ€í•œ ë‚´ìš©ì´ í•¨ê»˜ ë…¸ì¶œë¨
   
ë¬¸ì œí•´ê²°ì„ ìœ„í•´ ë¦¬ë·°ë¥¼ ì„ë² ë”© ëª¨ë¸ë¡œ ë²¡í„° ë³€í™˜í•˜ì—¬ ë²¡í„°í™”í•œ í† í°ê³¼ì˜ ìœ ì‚¬ë„ë¥¼ ì´ìš©í•´ ì§‘ê³„
~~~
ëŒ€ì‹œë³´ë“œì—ì„œ ì¢€ ë” ì •í™•í•˜ê³  ì§ê´€ì ì¸ í™•ì¸ì„ í•˜ê¸° ìœ„í•´ ê° ë¦¬ë·° í† í°ì„ ìœ ì‚¬í•œ í‚¤ì›Œë“œì™€ ë§¤ì¹­
í† í°í™” ì‹œ ì „ì²˜ë¦¬ ê³¼ì •ì„ ì¶”ê°€í•˜ì—¬ ë¶€ì •í˜•íƒœë¥¼ ìœ ì§€
~~~

#  :rocket:ì‹¤ë¬´ í™œìš©
## ì›Œë“œí´ë¼ìš°ë“œ ì „ì²˜ë¦¬ ì¶”ê°€


### ëŒ€ì‹œë³´ë“œ tokens table ì „ì²˜ë¦¬

- ëŒ€ì‹œë³´ë“œ ê°œì„ ì„ ìœ„í•´ í† í°ì„ ìˆ˜ê¸°ë§¤ì¹­í•´ì•¼í•˜ëŠ” ë“± ìˆ˜ì‘ì—…ì´ ë§ìŒ
- íŠ¹íˆ ë¹ˆë„ìˆ˜ ìƒìœ„ í† í°ì˜ í‚¤ì›Œë“œ ë¶„ë¥˜ëŠ” ë¶ˆê°€í”¼í•¨
- ìë™í™”ë˜ì§€ ì•Šì€ í”„ë¡œì„¸ìŠ¤ë¡œ ì¸í•œ **ìˆ˜ì‘ì—…ì„ ì¤„ì´ê¸° ìœ„í•œ ì‘ì—…**

![Untitled](./img/Untitled.png)

1ï¸âƒ£**í† í°í™”**

- ì§€ë„ konlpy mecab ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© ì¤‘
    - ìœ ì € ë‹¨ì–´ì‚¬ì „ ì¶”ê°€ê°€ëŠ¥ > í•­ìƒ ìƒˆë¡œìš´ ë‹¨ì–´ëŠ” ì¶”ê°€í•´ì•¼ í•¨
    - ì†ë„ê°€ ë¹ ë¦„
    - í’ˆì‚¬ ë§¤ì¹­ê¹Œì§€ ì ìš©ë¨
    - ì •í™•ë„ê°€ ë‹¤ì†Œ ë–¨ì–´ì§
    
    ```jsx
    #mecab
    'ì˜·', 'ì€', 'ì´ì˜', 'ì§€ë§Œ', 'êµ¬ê¹€', 'ì´', 'ë„ˆë¬´', 'ì˜', 'ìƒê²¨ìš”'
    ```
    
    ```jsx
    #okt
    'ì˜·', 'ì€', 'ì´ì˜ì§€ë§Œ', 'êµ¬ê¹€', 'ì´', 'ë„ˆë¬´', 'ì˜', 'ìƒê²¨ìš”â€™
    ```
    
    ```jsx
    #kkma
    'ì˜·', 'ì€', 'ì´ì˜', 'ì§€ë§Œ', 'êµ¬ê¹€', 'ì´', 'ë„ˆë¬´', 'ì˜', 'ìƒê¸°', 'ì–´ìš”â€™
    ```
    
- ë¹„ì§€ë„ sentencepiece ê³ ë ¤(í•™ìŠµì´ í•„ìš”í•¨, í’ˆì‚¬ ë§¤ì¹­ì´ ì•ˆë¨, ë§ì´ ë¹ ë¦„)
    - BPE
        - ìƒˆë¡œìš´ ë‹¨ì–´ì˜ ì¶”ê°€ ì—†ì´ ë¹ˆë„ê¸°ë°˜ ìë™ìœ¼ë¡œ ë‹¨ì–´ì‚¬ì „ í˜•ì„±
        - ì˜ˆì‹œ : abaa,  abcd, dcdf > Aaa , Acd, dcdf
            
        ```jsx
        'â–ì˜·ì€', 'â–ì´ì˜ì§€ë§Œ', 'â–êµ¬ê¹€ì´', 'â–ë„ˆë¬´', 'â–ì˜', 'â–ìƒê²¨ìš”â€™
        ```
            
    - wordpiece - í™•ë¥ ê¸°ë°˜
            
        ```jsx
        'á„‹á…©á†ºá„‹á…³á†«', 'á„‹á…µá„ˆá…³á„Œá…µá„†á…¡á†«', 'á„€á…®á„€á…µá†·á„‹á…µ', 'á„‚á…¥á„†á…®', 'á„Œá…¡á†¯', 'á„‰á…¢á†¼á„€á…§á„‹á…­â€™
        ```
            
- í”„ë¦¬íŠ¸ë ˆì¸ í† í¬ë‚˜ì´ì € skt kogpt2 tokenizer í•™ìŠµ
    - sentencepiece ê¸°ë°˜ í† í¬ë‚˜ì´ì €ë¼ì„œ bpeì™€ ê²°ê³¼ê°€ ë¹„ìŠ·í•¨
            
        ```jsx
        # í•™ìŠµ ì „
        'â–ì˜·ì€', 'â–ì´', 'ì˜', 'ì§€ë§Œ', 'â–êµ¬', 'ê¹€', 'ì´', 'â–ë„ˆë¬´', 'â–ì˜', 'â–ìƒê²¨', 'ìš”'
        
        # í•™ìŠµ í›„
        'â–ì˜·ì€', 'â–ì´ì˜ì§€ë§Œ', 'â–êµ¬ê¹€ì´', 'â–ë„ˆë¬´', 'â–ì˜', 'â–ìƒê²¨ìš”â€™
        ```
            
  ê¸°ë³¸ í† í¬ë‚˜ì´ì €ì—ì„œ í† í°í™”í•œ ê²°ê³¼ì™€ ë¦¬ë·° í•™ìŠµ í›„ í† í¬ë‚˜ì´ì €ì˜ í† í°í™” ê²°ê³¼ì°¨ì´ê°€ í™•ì—°
            

2ï¸âƒ£**ë¹ˆë„ìˆ˜ ìƒìœ„ í† í° ì¶”ì¶œ**

- ëª…ì‚¬ 1ìëŠ” ì œê±°
- í† í° ì¤‘ ëª…ì‚¬, ìš©ì–¸ ì¤‘ ë¹ˆë„ìˆ˜ ìƒìœ„ í† í° ì¶”ì¶œ
    - top p = 90% : ë¹ˆë„ìˆ˜ ëˆ„ì  í™•ë¥  90%,
    - top k = 1,000  : top p 90% ë‹¨ì–´ìˆ˜ê°€ 1,000ê°œ ì´ìƒì¼ ê²½ìš°

3ï¸âƒ£**ê¸°ë³¸í˜• ë³€í™˜ > í† í¬ë‚˜ì´ì €ì— ë”°ë¼ ì ìš© ë°©ë²•ì´ ë‹¤ë¦„**

- ìš©ì–¸ í•œ ë‘ ê¸€ìëŠ” ëì—  í˜•ìš©ì‚¬ â€˜~ë‹¤â€˜, ~~ë™ì‚¬ ~í•˜ë‹¤â€™~~ë¥¼ ë¶™ì„
    
  ê¼¬ê¼¬ë§ˆê°€ ê¸°ë³¸í˜• ë³€í™˜ì— ê°€ì¥ ì•Œë§ë‹¤
    

4ï¸âƒ£**ìœ ì‚¬í† í°(ìš©ì–¸) êµ°ì§‘í™”**

- ë‹¨ì–´ê¸°ë°˜ ì„ë² ë”© í™œìš©
    - word2vec
    
    ![Untitled](./img/Untitled1.png)
    
    ìœ ì‚¬ë‹¨ì–´ ì™¸ì˜ ë‹¨ì–´ë„ ë§¤ì¹­ë˜ëŠ” ë¬¸ì œê°€ ìˆìŒ (ì •í™•ë„ì˜ ì„ê³„ê°’ì´ í•„ìš”í•¨)  
    ì„ë² ë”© ëª¨ë¸ì€ ê¸¸ë‹¤ì™€ ì§§ë‹¤ëŠ” ê¸¸ì´ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ë§¤ìš° ì¸ì ‘í•œ ë‹¨ì–´ë¼ê³  ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ëŠ” ê²½í–¥ì´ ìˆìŒ (ë¬¸ì¥ ê¸°ë°˜ ì„ë² ë”© ëª¨ë¸ openaië‚˜ robertaë„ ë™ì¼í•¨)  
    â€˜ì–´ë–¤ ëª…ì‚¬ê°€ ë§ì´ ì‚¬ìš©í–ˆë‚˜â€™ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤ > `ê¸¸ë‹¤` ê¸°ì¥, ë¬´ë¦, íŒ”, ì†Œë§¤  
    í† í° í…Œì´ë¸”ì—ì„œ ë¹ˆë„ìˆ˜ ìƒìœ„ ìµœì¢… ì¶œë ¥ í˜•íƒœì˜ í† í°ì˜ ìœ ì‚¬ í† í° ì¶”ì¶œ top_15  
    â€˜ë‹¤â€™ ê°€ ë¶™ì§€ ì•Šì€ í† í°í™” ê¸°ë³¸ ìƒíƒœê°€ ë§¤ì¹­ë˜ì–´ ë‚˜ì¤‘ì— í’ˆì‚¬ì™€ ê¸°ë³¸í˜• ë³€í™˜ í† í°ì˜ ë§¤ì¹­ì´ í•„ìš”  
    ì •í™•ë„ ê°œì„ ì„ ìœ„í•œ í•™ìŠµë°ì´í„° ì •ë¦¬ê°€ í•„ìš”í•  ë“¯  
    
    ![Untitled](./img/Untitled2.png) 
    ![Untitled](./img/Untitled3.png)
    ![Untitled](./img/Untitled4.png)
    ![Untitled](./img/Untitled5.png)
    ![Untitled](./img/Untitled6.png)
    ![Untitled](./img/Untitled7.png)
        

## RAG í™œìš©
ê¸°ì¡´ konlpy mecab í† í¬ë‚˜ì´ì €ë¥¼ í™œìš©í•œ ì›Œë“œí´ë¼ìš°ë“œë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ì„ ì‹œë„í•˜ì˜€ìŠµë‹ˆë‹¤.  
- ëª…ì‚¬ë§Œ í˜•íƒœì†Œ ì¶”ì¶œí•œë‹¤. ëŒ€ì‹œë³´ë“œ ì›Œë“œí´ë¼ìš°ë“œì—ë„ ëª…ì‚¬ë§Œ ë…¸ì¶œ  
- ì£¼ìš”ëª…ì‚¬ì— ì¸ì ‘í•œ â€˜ë™ì‚¬â€™í˜•ìš©ì‚¬â€™ ë‹¨ì–´ëŠ” chatGPTë¡œ ìƒì„±  
- ëª…ì‚¬+ë™ì‚¬ ë¬¸ì¥ì„ ì´ìš©í•˜ì—¬ ì„ë² ë”© ìœ ì‚¬ ë¦¬ë·° ê²€ìƒ‰ ì§‘ê³„  

í•˜ì´ë¼ì´íŠ¸ì— í‚¤ì›Œë“œê°€ ì¤‘ë³µë˜ëŠ” ë¶€ë¶„ì„ ê°œì„ í•˜ê¸° ìœ„í•´ ë¹ˆë„ìˆ˜ê°€ ë†’ì€ í† í°ì„ í‚¤ì›Œë“œ ë¶„ë¥˜ ë° ì§ê´€ì ì¸ ë©”ì„¸ì§€ ì „ë‹¬ì„ ìœ„í•œ ë¬¸ì¥ ìƒì„±í•˜ê³   
ìƒì„±ëœ ë¬¸ì¥ì„ ì§‘ê³„í•˜ê¸° ìœ„í•´ ì‹¤ì‹œê°„ ìœ ì‚¬ë„ ê²€ìƒ‰í•˜ì—¬ ì§‘ê³„í•˜ëŠ” ë°©ë²•ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.  

![ex_screenshot](./img/process.png)  

1. ëª¨ë“  ë¦¬ë·°ë¥¼ ì„ë² ë”©ëª¨ë¸ì— ë„£ì–´ ë²¡í„°ë¡œ ë³€í™˜ > ë¬¸ì¥ ìƒì„± ì‹œ ë­ì²´ì¸ ë©”ëª¨ë¦¬ í™œìš©  
2. ë¹ˆë„ìˆ˜ ë†’ì€ ëª…ì‚¬ ì¶”ì¶œ í›„ ë©”ëª¨ë¦¬ í™œìš©í•˜ì—¬ ë¬¸ì¥ ìƒì„±  
3. ìƒì„±ëœ ë¬¸ì¥ë„ ë²¡í„°ë¡œ ë³€í™˜ ë° í‚¤ì›Œë“œ ë¶„ë¥˜  
4. ë§ˆì§€ë§‰ìœ¼ë¡œ ëŒ€ì‹œë³´ë“œì—ì„œ ì„ íƒí•œ ìƒì„± ë¬¸ì¥ì— ìœ ì‚¬í•œ ë¦¬ë·° ê²€ìƒ‰í•˜ì—¬ ì§‘ê³„  


### ì „ì²˜ë¦¬ í…Œì´ë¸” ìƒì„±
ë¹ˆë„ìˆ˜ ë†’ì€ ëª…ì‚¬ë¥¼ ì¶”ì¶œí•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.
```python
from preprocessing import review_tag, re90

review_tag(in_path,out_path,date)
re90(in_path,out_path)
```

### ì„ë² ë”© ìƒì„±
ì˜¤í”ˆai ì„ë² ë”© ëª¨ë¸ì˜ api ê²°ê³¼ë¥¼ ë°›ì•„ faiss ì¸ë±ìŠ¤ë¥¼ ì €ì¥í•˜ëŠ” ê³¼ì •ì…ë‹ˆë‹¤.
```python
from review_embedding import Review_Embedding

review_embedding = Review_Embedding(out_path)
review_embedding.create_dataset(out_path)
review_embedding.create_index(index_path)
```

### ë¬¸ì¥ ìƒì„±
ë­ì²´ì¸ ë©”ëª¨ë¦¬ í™œìš© ì½”ë“œì…ë‹ˆë‹¤.  
```python
from sentence_create import Create_Sentence

nn = pd.read_csv(out_path+"re90.csv")
text = nn['token'][0]
template="""
1.ë‹¹ì‹ ì€ ëª…ì‚¬ ë‹¤ìŒì— ì˜¬ ë™ì‚¬ë‚˜ í˜•ìš©ì‚¬ë¥¼ êµ¬í•˜ëŠ” aiì…ë‹ˆë‹¤.

2.ìµœì¢… ëŒ€í‘œì ì¸ ë™ì‚¬, í˜•ìš©ì‚¬ ìµœëŒ€ 4ê°œë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.

3.í˜•ìš©ì‚¬ë‚˜ ë™ì‚¬ëŠ” 'ë‹¤'ë¡œ ëë‚˜ëŠ” í˜•íƒœë¡œ ì¶œë ¥í•©ë‹ˆë‹¤.
ì˜ˆì‹œ
ì§§ì€, ì§§ì•„ì„œ > ì§§ë‹¤
ê¸¸ì–´ì„œ, ê¸´ > ê¸¸ë‹¤

4.ë‹µë³€ì€ ë‹¨ë‹µí˜•ìœ¼ë¡œ í•©ë‹ˆë‹¤.
ì˜ˆì‹œ
ì…ë ¥: ê¸¸ì´
ì¶œë ¥: ì§§ë‹¤,ê¸¸ë‹¤
"""
human_template="ë‹¤ìŒ ëª…ì‚¬ ë‹¤ìŒ ë‹¨ì–´ë¥¼ êµ¬í•´ì¤˜, {text}"

create_sentence = Create_Sentence(index_path,"faiss0",template,human_template)
create_sentence.create_rag(text)
```

### í‚¤ì›Œë“œ ë¶„ë¥˜
ë‹¨ìˆœ ì›ìƒ· ëŸ¬ë‹ ìƒì„±ì…ë‹ˆë‹¤.  
```python
from sentence_create import Create_Sentence

text = "ì˜ˆë»ìš”"
template="""
1.ë‹¹ì‹ ì€ í‚¤ì›Œë“œë¥¼ ë¶„ë¥˜í•˜ëŠ” aiì…ë‹ˆë‹¤.

2.í‚¤ì›Œë“œ 14ê°œì´ê³ , ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
'ê°€ê²©','ê¸°ëŠ¥ì„±','ê¸¸ì´','ë””ìì¸','ë¼ì¸(í•)','ë§ˆê°ì²˜ë¦¬','ë°°ì†¡','ì‚¬ì´ì¦ˆ','ìƒ‰ìƒ','ì†Œì¬','ìŠ¤íƒ€ì¼','ì‹ ì¶•ì„±','ì°©ìš©ê°','í’ˆì§ˆ'

3.ê°€ì¥ ìœ ì‚¬í•œ ì˜ë¯¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í‚¤ì›Œë“œë¡œ ë¶„ë¥˜í•©ë‹ˆë‹¤.
ì˜ˆì‹œ
ëª¸ì— ë§ë‹¤ > ë¼ì¸(í•)
ë°”ì§€ ê¸¸ë‹¤ > ê¸¸ì´

4.ë‹µë³€ì€ ë‹¨ë‹µí˜•ìœ¼ë¡œ í•©ë‹ˆë‹¤.
ì˜ˆì‹œ
ì…ë ¥: ì˜·ì´ ì´ë»ìš”
ì¶œë ¥: ë””ìì¸
"""
human_template="ë‹¤ìŒ ë¬¸ì¥ì„ ë¶„ë¥˜í•´ì¤˜, {text}"

create_sentence = Create_Sentence(index_path,"faiss0",template,human_template)
create_sentence.create(text)
```

### ìœ ì‚¬ë„ ê²€ìƒ‰
ì¸ì ‘í•œ kê°œì˜ ìœ ì‚¬í•œ ê²°ê³¼ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.
ìì¹´ë“œ ìœ ì‚¬ë„ ì„ê³„ê°’ì€ 0.3ìœ¼ë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.
```python
from final_output import Search

search = Search(index_path,"faiss0")
txt = "ë””ìì¸ì´ ì˜ˆë»ìš”"
search.search(10,0.3,txt)
```
